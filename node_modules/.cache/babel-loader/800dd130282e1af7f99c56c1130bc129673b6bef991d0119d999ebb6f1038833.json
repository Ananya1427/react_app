{"ast":null,"code":"var _jsxFileName = \"/Users/venkat/Downloads/React/Food_App/react_app/src/Pages/Partner/FileUploadCopy.js\",\n  _s = $RefreshSig$();\nimport React from 'react';\nimport Resizer from 'react-image-file-resizer';\nimport axios from 'axios';\nimport { useSelector } from 'react-redux';\nimport { Avatar, Badge } from 'antd';\nimport { toast } from 'react-toastify';\nimport './FileUpload.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst FileUploadCopy = ({\n  id,\n  images,\n  setImages,\n  setLoading\n}) => {\n  _s();\n  const {\n    user\n  } = useSelector(state => ({\n    ...state\n  }));\n  // const uploadedImages = localStorage.getItem('uploadedImages');\n\n  // useEffect(() => {\n  // \tconsole.log('Check-->uploadedImages: ', uploadedImages);\n  // \tsetImages(uploadedImages);\n  // }, [])\n\n  const fileUploadAndResize = e => {\n    e.preventDefault();\n    let files = e.target.files; // 3\n    let allUploadedFiles = images.urls || [];\n    let idToken = user ? user.token : '';\n    if (files) {\n      setLoading(true);\n      for (let i = 0; i < files.length; i++) {\n        Resizer.imageFileResizer(files[i], 720, 720, 'JPEG', 100, 0, uri => {\n          axios.post(`${process.env.REACT_APP_API}/uploadimages`, {\n            image: uri\n          }, {\n            headers: {\n              idToken\n            }\n          }).then(res => {\n            if (res.status === 200) {\n              const {\n                public_id,\n                url,\n                message\n              } = res.data;\n              toast.success(message);\n              allUploadedFiles.push({\n                public_id,\n                url\n              });\n              setImages({\n                ...images,\n                urls: allUploadedFiles\n              });\n              // localStorage.setItem('uploadedImages', { ...images, urls: allUploadedFiles });\n            } else {\n              toast.error(res.data.message);\n            }\n            setLoading(false);\n          }).catch(error => {\n            setLoading(false);\n            toast.error(error);\n          });\n        }, 'base64');\n      }\n    }\n    // send back to server to upload to cloudinary\n    // set url to images[] in the parent component state - ProductCreate\n  };\n\n  const handleImageRemove = public_id => {\n    let idToken = user ? user.token : '';\n    setLoading(true);\n    axios.post(`${process.env.REACT_APP_API}/removeimage`, {\n      public_id\n    }, {\n      headers: {\n        idToken\n      }\n    }).then(res => {\n      if (res.status === 200) {\n        toast.success(res.data.message);\n        const {\n          urls\n        } = images;\n        let filteredImages = urls.filter(item => {\n          return item.public_id !== public_id;\n        });\n        setImages({\n          ...images,\n          urls: filteredImages\n        });\n        // localStorage.setItem('uploadedImages', { ...images, urls: filteredImages });\n      } else {\n        toast.error(res.data.message);\n      }\n      setLoading(false);\n    }).catch(error => {\n      setLoading(false);\n      toast.error(error);\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n      htmlFor: id,\n      className: \"btn btn-filled btn-raised\",\n      children: [\"Choose File\", /*#__PURE__*/_jsxDEV(\"input\", {\n        id: id,\n        type: \"file\",\n        multiple: true,\n        hidden: true,\n        accept: \"images/*\",\n        onChange: fileUploadAndResize\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-3\",\n      children: images && images.urls && images.urls.map(image => /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: /*#__PURE__*/_jsxDEV(Badge, {\n          count: \"X\",\n          onClick: () => handleImageRemove(image.public_id),\n          style: {\n            cursor: 'pointer'\n          },\n          children: /*#__PURE__*/_jsxDEV(Avatar, {\n            src: image.url,\n            size: 100,\n            shape: \"square\",\n            className: \"ml-3\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 9\n          }, this)\n        }, image.public_id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 8\n        }, this)\n      }, void 0, false))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true);\n};\n_s(FileUploadCopy, \"HA6wZhGeXNR9tzJ3aDGGsGCdOyI=\", false, function () {\n  return [useSelector];\n});\n_c = FileUploadCopy;\nexport default FileUploadCopy;\nvar _c;\n$RefreshReg$(_c, \"FileUploadCopy\");","map":{"version":3,"names":["React","Resizer","axios","useSelector","Avatar","Badge","toast","jsxDEV","_jsxDEV","Fragment","_Fragment","FileUploadCopy","id","images","setImages","setLoading","_s","user","state","fileUploadAndResize","e","preventDefault","files","target","allUploadedFiles","urls","idToken","token","i","length","imageFileResizer","uri","post","process","env","REACT_APP_API","image","headers","then","res","status","public_id","url","message","data","success","push","error","catch","handleImageRemove","filteredImages","filter","item","children","htmlFor","className","type","multiple","hidden","accept","onChange","fileName","_jsxFileName","lineNumber","columnNumber","map","count","onClick","style","cursor","src","size","shape","_c","$RefreshReg$"],"sources":["/Users/venkat/Downloads/React/Food_App/react_app/src/Pages/Partner/FileUploadCopy.js"],"sourcesContent":["import React from 'react';\nimport Resizer from 'react-image-file-resizer';\nimport axios from 'axios';\nimport { useSelector } from 'react-redux';\nimport { Avatar, Badge } from 'antd';\nimport { toast } from 'react-toastify';\n\nimport './FileUpload.css';\n\nconst FileUploadCopy = ({ id, images, setImages, setLoading }) => {\n\tconst { user } = useSelector((state) => ({ ...state }));\n\t// const uploadedImages = localStorage.getItem('uploadedImages');\n\n\t// useEffect(() => {\n\t// \tconsole.log('Check-->uploadedImages: ', uploadedImages);\n\t// \tsetImages(uploadedImages);\n\t// }, [])\n\n\tconst fileUploadAndResize = (e) => {\n\t\te.preventDefault();\n\t\tlet files = e.target.files; // 3\n\t\tlet allUploadedFiles = images.urls || [];\n\t\tlet idToken = user ? user.token : '';\n\n\t\tif (files) {\n\t\t\tsetLoading(true);\n\t\t\tfor (let i = 0; i < files.length; i++) {\n\t\t\t\tResizer.imageFileResizer(\n\t\t\t\t\tfiles[i],\n\t\t\t\t\t720,\n\t\t\t\t\t720,\n\t\t\t\t\t'JPEG',\n\t\t\t\t\t100,\n\t\t\t\t\t0,\n\t\t\t\t\t(uri) => {\n\t\t\t\t\t\taxios\n\t\t\t\t\t\t\t.post(\n\t\t\t\t\t\t\t\t`${process.env.REACT_APP_API}/uploadimages`,\n\t\t\t\t\t\t\t\t{ image: uri },\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\t\t\tidToken\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.then((res) => {\n\t\t\t\t\t\t\t\tif (res.status === 200) {\n\t\t\t\t\t\t\t\t\tconst { public_id, url, message } = res.data;\n\t\t\t\t\t\t\t\t\ttoast.success(message);\n\t\t\t\t\t\t\t\t\tallUploadedFiles.push({ public_id, url });\n\t\t\t\t\t\t\t\t\tsetImages({ ...images, urls: allUploadedFiles });\n\t\t\t\t\t\t\t\t\t// localStorage.setItem('uploadedImages', { ...images, urls: allUploadedFiles });\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\ttoast.error(res.data.message);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tsetLoading(false);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\t\t\tsetLoading(false);\n\t\t\t\t\t\t\t\ttoast.error(error);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\t'base64'\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\t// send back to server to upload to cloudinary\n\t\t// set url to images[] in the parent component state - ProductCreate\n\t};\n\n\tconst handleImageRemove = (public_id) => {\n\t\tlet idToken = user ? user.token : '';\n\t\tsetLoading(true);\n\t\taxios\n\t\t\t.post(\n\t\t\t\t`${process.env.REACT_APP_API}/removeimage`,\n\t\t\t\t{ public_id },\n\t\t\t\t{\n\t\t\t\t\theaders: {\n\t\t\t\t\t\tidToken\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t)\n\t\t\t.then((res) => {\n\t\t\t\tif (res.status === 200) {\n\t\t\t\t\ttoast.success(res.data.message);\n\t\t\t\t\tconst { urls } = images;\n\t\t\t\t\tlet filteredImages = urls.filter((item) => {\n\t\t\t\t\t\treturn item.public_id !== public_id;\n\t\t\t\t\t});\n\t\t\t\t\tsetImages({ ...images, urls: filteredImages });\n\t\t\t\t\t// localStorage.setItem('uploadedImages', { ...images, urls: filteredImages });\n\t\t\t\t} else {\n\t\t\t\t\ttoast.error(res.data.message);\n\t\t\t\t}\n\t\t\t\tsetLoading(false);\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tsetLoading(false);\n\t\t\t\ttoast.error(error);\n\n\t\t\t});\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t<label htmlFor={id} className='btn btn-filled btn-raised'>\n\t\t\t\tChoose File\n\t\t\t\t<input\n\t\t\t\t\tid={id}\n\t\t\t\t\ttype='file'\n\t\t\t\t\tmultiple\n\t\t\t\t\thidden\n\t\t\t\t\taccept='images/*'\n\t\t\t\t\tonChange={fileUploadAndResize}\n\t\t\t\t/>\n\t\t\t</label>\n\t\t\t<div className='mt-3'>\n\t\t\t\t{images && images.urls &&\n\t\t\t\t\timages.urls.map((image) => (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\t\tcount='X'\n\t\t\t\t\t\t\t\tkey={image.public_id}\n\t\t\t\t\t\t\t\tonClick={() => handleImageRemove(image.public_id)}\n\t\t\t\t\t\t\t\tstyle={{ cursor: 'pointer' }}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Avatar\n\t\t\t\t\t\t\t\t\tsrc={image.url}\n\t\t\t\t\t\t\t\t\tsize={100}\n\t\t\t\t\t\t\t\t\tshape='square'\n\t\t\t\t\t\t\t\t\tclassName='ml-3'\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t</>\n\t\t\t\t\t))}\n\t\t\t</div>\n\t\t</>\n\t);\n};\n\nexport default FileUploadCopy;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}