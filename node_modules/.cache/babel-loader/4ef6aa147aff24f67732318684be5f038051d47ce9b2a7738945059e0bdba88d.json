{"ast":null,"code":"import React,{useState}from'react';import{Link}from'react-router-dom';import{signInWithEmailAndPassword}from'firebase/auth';import{toast}from'react-toastify';import{useNavigate}from'react-router-dom';import{useDispatch}from'react-redux';import{auth}from'../../firebase';import{checkUser,currentUser}from'../../Functions/Auth';import'./Auth.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const Login=()=>{const navigate=useNavigate();const dispatch=useDispatch();const[email,setEmail]=useState('');const[password,setPassword]=useState('');const[loading,setLoading]=useState(false);const rolebasedredirect=role=>{if(role==='admin'){navigate('/');}else if(role==='crew'){navigate('/crew-dashboard');}else if(role==='user'){navigate('/');}};const handleSubmit=async e=>{e.preventDefault();setLoading(true);checkUser(email).then(res=>{if(res.status===202){toast.error(res.data.message);navigate('/create-account');setLoading(false);}else{validateCredentials();}}).catch(err=>{toast.error(err);setLoading(false);});};const validateCredentials=()=>{signInWithEmailAndPassword(auth,email,password).then(res=>{const{user}=res;toast.success('Login Success!');dipatchUserDetails(user);setLoading(false);}).catch(e=>{toast.error('Something went wrong...please try again');setLoading(false);});};const dipatchUserDetails=async user=>{const idTokenResult=await user.getIdTokenResult();let options=[];let uaoptions=[];currentUser(user.email,idTokenResult.token).then(res=>{if(res.status===200){const{firstName,lastName,dob,gender,email,contact,address,state,city,pinCode,role,_id}=res.data.user;toast.success(\"Welcome \".concat(firstName));const{idToken}=res.config.headers;switch(role){case'admin':options=['Dashboard','Add Restaurant','Manage Restaurants','Manage Users','Profile'];break;case'restaurant':options=['Dashboard','Create Category','Manage Categories','Manage Users','Profile'];break;case'crew':options=['Dashboard','Current Order','Orders History','Profile'];break;default:options=['Dashboard','Current Order','Orders History','Profile'];break;}dispatch({type:'LOGGED_IN_USER',payload:{firstName,lastName,dob,gender,email,contact,address,state,city,pinCode,role,_id,options,uaoptions,token:idToken}});rolebasedredirect(role);}else{toast.error(res.data.message);}}).catch(()=>toast.error('Something went wromg...please try again'));};return/*#__PURE__*/_jsx(\"div\",{className:\"container mt-5 login-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row mt-5 pt-5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-lg-6 offset-lg-3 col-md-8 offset-md-2 col-10 offset-1 shadow p-lg-5 p-md-4 p-3\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"container-fluid\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"form-group mb-4 text-center\",children:loading?/*#__PURE__*/_jsx(\"h3\",{children:\"Loading...\"}):/*#__PURE__*/_jsx(\"h3\",{children:\"Login\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group my-3 row p-0\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",className:\"col-md-3 d-none d-md-block col-form-label text-end fw-bold fs-6\",children:\"Email\"}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-8 col-12 mb-3 mb-md-1 p-0\",children:/*#__PURE__*/_jsx(\"input\",{id:\"email\",type:\"email\",className:\"form-control w-100\",value:email,required:true,onChange:e=>setEmail(e.target.value),placeholder:\"abc@example.com\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group my-3 row p-0\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",className:\"col-md-3 d-none d-md-block col-form-label text-xl-end fw-bold fs-6\",children:\"Password\"}),/*#__PURE__*/_jsx(\"div\",{className:\"col-md-8 col-12 mb-3 mb-md-1 p-0\",children:/*#__PURE__*/_jsx(\"input\",{id:\"password\",type:\"password\",className:\"form-control w-100\",value:password,required:true,onChange:e=>setPassword(e.target.value),placeholder:\"Password\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group row p-0\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4 col-6 offset-md-3 text-start p-0\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-raised btn-filled\",type:\"submit\",disabled:!email||password.length<6,children:\"Login\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group row p-0 justify-content-end\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4 col-10 text-md-start text-end\",children:/*#__PURE__*/_jsx(Link,{to:\"/reset-password\",className:\"text-danger text-decoration-none\",children:\"Forgot Password\"})})})]})})})});};export default Login;","map":{"version":3,"names":["React","useState","Link","signInWithEmailAndPassword","toast","useNavigate","useDispatch","auth","checkUser","currentUser","jsx","_jsx","jsxs","_jsxs","Login","navigate","dispatch","email","setEmail","password","setPassword","loading","setLoading","rolebasedredirect","role","handleSubmit","e","preventDefault","then","res","status","error","data","message","validateCredentials","catch","err","user","success","dipatchUserDetails","idTokenResult","getIdTokenResult","options","uaoptions","token","firstName","lastName","dob","gender","contact","address","state","city","pinCode","_id","concat","idToken","config","headers","type","payload","className","children","onSubmit","htmlFor","id","value","required","onChange","target","placeholder","disabled","length","to"],"sources":["/Users/venkat/Downloads/react/Food_App/react_app/src/Pages/Auth/Login.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { signInWithEmailAndPassword } from 'firebase/auth';\nimport { toast } from 'react-toastify';\nimport { useNavigate } from 'react-router-dom';\nimport { useDispatch } from 'react-redux';\n\nimport { auth } from '../../firebase';\nimport { checkUser, currentUser } from '../../Functions/Auth';\n\nimport './Auth.css';\n\nconst Login = () => {\n    const navigate = useNavigate();\n    const dispatch = useDispatch();\n\n    const [email, setEmail] = useState('');\n    const [password, setPassword] = useState('');\n    const [loading, setLoading] = useState(false);\n\n    const rolebasedredirect = (role) => {\n        if (role === 'admin') {\n            navigate('/');\n        }\n        else if (role === 'crew') {\n            navigate('/crew-dashboard');\n        }\n        else if (role === 'user') {\n            navigate('/');\n        }\n    };\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        setLoading(true);\n        checkUser(email)\n            .then(res => {\n                if (res.status === 202) {\n                    toast.error(res.data.message);\n                    navigate('/create-account');\n                    setLoading(false);\n                } else {\n                    validateCredentials();\n                }\n            })\n            .catch((err) => {\n                toast.error(err);\n                setLoading(false);\n            })\n    }\n\n    const validateCredentials = () => {\n        signInWithEmailAndPassword(auth, email, password)\n            .then(res => {\n                const { user } = res;\n                toast.success('Login Success!');\n                dipatchUserDetails(user);\n                setLoading(false);\n            })\n            .catch(e => {\n                toast.error('Something went wrong...please try again');\n                setLoading(false);\n            })\n    }\n\n    const dipatchUserDetails = async (user) => {\n        const idTokenResult = await user.getIdTokenResult();\n        let options = [];\n        let uaoptions = [];\n        currentUser(user.email, idTokenResult.token)\n            .then((res) => {\n                if (res.status === 200) {\n                    const { firstName, lastName, dob, gender, email, contact, address, state, city, pinCode, role, _id } = res.data.user;\n                    toast.success(`Welcome ${firstName}`);\n                    const { idToken } = res.config.headers;\n                    switch (role) {\n                        case 'admin': options = ['Dashboard', 'Add Restaurant', 'Manage Restaurants', 'Manage Users', 'Profile'];\n                            break;\n                        case 'restaurant': options = ['Dashboard', 'Create Category', 'Manage Categories', 'Manage Users', 'Profile'];\n                            break;\n                        case 'crew': options = ['Dashboard', 'Current Order', 'Orders History', 'Profile'];\n                            break;\n                        default: options = ['Dashboard', 'Current Order', 'Orders History', 'Profile'];\n                            break;\n                    }\n                    dispatch({\n                        type: 'LOGGED_IN_USER',\n                        payload: { firstName, lastName, dob, gender, email, contact, address, state, city, pinCode, role, _id, options, uaoptions, token: idToken }\n                    });\n                    rolebasedredirect(role);\n                } else {\n                    toast.error(res.data.message);\n                }\n            })\n            .catch(() => toast.error('Something went wromg...please try again'))\n    }\n\n    return (\n        <div className='container mt-5 login-container'>\n            <div className='row mt-5 pt-5'>\n                <div className='col-lg-6 offset-lg-3 col-md-8 offset-md-2 col-10 offset-1 shadow p-lg-5 p-md-4 p-3'>\n                    <form onSubmit={handleSubmit} className='container-fluid'>\n                        <div className='form-group mb-4 text-center'>\n                            {loading ? <h3>Loading...</h3> : <h3>Login</h3>}\n                        </div>\n                        <div className='form-group my-3 row p-0'>\n                            <label htmlFor='email' className='col-md-3 d-none d-md-block col-form-label text-end fw-bold fs-6'>Email</label>\n                            <div className='col-md-8 col-12 mb-3 mb-md-1 p-0'>\n                                <input\n                                    id='email'\n                                    type='email'\n                                    className='form-control w-100'\n                                    value={email}\n                                    required\n                                    onChange={(e) => setEmail(e.target.value)}\n                                    placeholder='abc@example.com'\n                                />\n                            </div>\n                        </div>\n                        <div className='form-group my-3 row p-0'>\n                            <label htmlFor='password' className='col-md-3 d-none d-md-block col-form-label text-xl-end fw-bold fs-6'>Password</label>\n                            <div className='col-md-8 col-12 mb-3 mb-md-1 p-0'>\n                                <input\n                                    id='password'\n                                    type='password'\n                                    className='form-control w-100'\n                                    value={password}\n                                    required\n                                    onChange={(e) => setPassword(e.target.value)}\n                                    placeholder='Password'\n                                />\n                            </div>\n                        </div>\n\n\n                        <div className='form-group row p-0'>\n                            <div className='col-md-4 col-6 offset-md-3 text-start p-0'>\n                                <button className='btn btn-raised btn-filled' type='submit' disabled={!email || password.length < 6}>\n                                    Login\n                                </button>\n                            </div>\n                        </div>\n                        <div className='form-group row p-0 justify-content-end'>\n                            <div className='col-md-4 col-10 text-md-start text-end'>\n                                <Link to='/reset-password' className='text-danger text-decoration-none'>\n                                    Forgot Password\n                                </Link>\n                            </div>\n                        </div>\n                    </form>\n\n                </div>\n            </div>\n        </div>\n    )\n}\n\nexport default Login;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}