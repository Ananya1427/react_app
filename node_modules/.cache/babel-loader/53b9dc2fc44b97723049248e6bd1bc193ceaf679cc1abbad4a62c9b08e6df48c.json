{"ast":null,"code":"var _s = $RefreshSig$();\nimport React from 'react';\nconst customHook = ({\n  setLoading,\n  user,\n  cart,\n  items,\n  setItems,\n  restaurant,\n  navigate,\n  dispatch,\n  toast,\n  createOrUpdateCart\n}) => {\n  _s();\n  const handleRoute = option => {\n    let routes = option.split('-');\n    return `${routes.length > 1 ? routes.map(route => route[0].toUpperCase().concat(route.slice(1))).join(' ') : routes[0][0].toUpperCase().concat(routes[0].slice(1))}`;\n  };\n  useEffect(() => {\n    setLoading(true);\n    getRestaurant(handleRoute(location.pathname.split('/')[2])).then(res => {\n      if (res.status === 200) {\n        setRestaurant(res.data.restaurant);\n        setCuisines(res.data.cuisines);\n        toast.success(res.data.message);\n      } else {\n        toast.error(res.data.message);\n      }\n      setLoading(false);\n    }).catch(error => {\n      toast.error(error);\n      setLoading(false);\n    });\n  }, []);\n  let itemsArr = [];\n  let cuisinesArr = [];\n  let index = -1;\n  let itemIndex = -1;\n  const handleAddProduct = obj => {\n    setLoading(true);\n    if (user) {\n      var _itemsArr;\n      const {\n        product,\n        count\n      } = obj;\n      let arr = {\n        cuisineId: product._id,\n        title: product.title,\n        description: product.description,\n        price: product.price,\n        count: count,\n        quantity: product.quantity,\n        images: product.images\n      };\n      itemsArr = (cart === null || cart === void 0 ? void 0 : cart.items) || items;\n      itemIndex = (_itemsArr = itemsArr) === null || _itemsArr === void 0 ? void 0 : _itemsArr.findIndex(item => item.orderFrom === (restaurant === null || restaurant === void 0 ? void 0 : restaurant.email));\n      if (itemIndex !== -1) {\n        var _itemsArr$itemIndex;\n        cuisinesArr = (_itemsArr$itemIndex = itemsArr[itemIndex]) === null || _itemsArr$itemIndex === void 0 ? void 0 : _itemsArr$itemIndex.cuisines;\n        index = cuisinesArr && cuisinesArr.findIndex(item => item.cuisineId === arr.cuisineId);\n        if (index !== -1) {\n          if (cuisinesArr[index].count === Number(arr.count)) {\n            toast.error('Product exist in the cart with same count');\n            setLoading(false);\n          } else {\n            cuisinesArr[index].count = arr.count;\n            let dummyArr = {\n              cuisines: cuisinesArr,\n              orderFrom: restaurant === null || restaurant === void 0 ? void 0 : restaurant.email\n            };\n            itemsArr[itemIndex] = dummyArr;\n            handleCommon();\n          }\n        } else {\n          cuisinesArr.push(arr);\n          let dummyArr = {\n            cuisines: cuisinesArr,\n            orderFrom: restaurant === null || restaurant === void 0 ? void 0 : restaurant.email\n          };\n          itemsArr[itemIndex] = dummyArr;\n          handleCommon();\n        }\n      } else {\n        cuisinesArr = [];\n        cuisinesArr.push(arr);\n        let dummyArr = {\n          cuisines: cuisinesArr,\n          orderFrom: restaurant === null || restaurant === void 0 ? void 0 : restaurant.email\n        };\n        itemsArr.push(dummyArr);\n        handleCommon();\n      }\n    } else {\n      setLoading(false);\n      toast.error('Please login/resgister to add items to the cart');\n      navigate('/login');\n    }\n  };\n  const handleCommon = () => {\n    let cartTotal = 0;\n    let cartQuantity = 0;\n    for (let i = 0; i < cuisinesArr.length; i++) {\n      cartTotal = cartTotal + cuisinesArr[i].price * cuisinesArr[i].count;\n      cartQuantity = cartQuantity + cuisinesArr[i].count;\n    }\n    let shipping = (cartTotal * 0.05).toFixed(2);\n    createOrUpdateCart({\n      items: itemsArr,\n      shipping,\n      cartTotal,\n      cartQuantity,\n      totalAfterDiscount: 100,\n      orderdBy: user.email\n    }, user.token).then(res => {\n      if (res.status === 200) {\n        setItems(res.data.cart.items);\n        dispatch({\n          type: 'CART',\n          payload: res.data.cart\n        });\n        toast.success(res.data.message);\n      } else {\n        toast.error(res.data.message);\n      }\n      setLoading(false);\n    }).catch(error => {\n      setLoading(false);\n      toast.error(error);\n    });\n  };\n  return {\n    handleAddProduct\n  };\n};\n_s(customHook, \"OD7bBpZva5O2jO+Puf00hKivP7c=\");\nexport default customHook;","map":{"version":3,"names":["React","customHook","setLoading","user","cart","items","setItems","restaurant","navigate","dispatch","toast","createOrUpdateCart","_s","handleRoute","option","routes","split","length","map","route","toUpperCase","concat","slice","join","useEffect","getRestaurant","location","pathname","then","res","status","setRestaurant","data","setCuisines","cuisines","success","message","error","catch","itemsArr","cuisinesArr","index","itemIndex","handleAddProduct","obj","_itemsArr","product","count","arr","cuisineId","_id","title","description","price","quantity","images","findIndex","item","orderFrom","email","_itemsArr$itemIndex","Number","dummyArr","handleCommon","push","cartTotal","cartQuantity","i","shipping","toFixed","totalAfterDiscount","orderdBy","token","type","payload"],"sources":["/Users/venkat/Downloads/React/Food_App/react_app/src/Pages/User/common.js"],"sourcesContent":["import React from 'react';\n\nconst customHook = ({\n    setLoading,\n    user,\n    cart,\n    items,\n    setItems,\n    restaurant,\n    navigate,\n    dispatch,\n    toast,\n    createOrUpdateCart\n}) => {\n\n    const handleRoute = (option) => {\n        let routes = option.split('-');\n        return `${routes.length > 1 ? routes.map(route => route[0].toUpperCase().concat(route.slice(1))).join(' ') : routes[0][0].toUpperCase().concat(routes[0].slice(1))}`;\n    }\n\n    useEffect(() => {\n        setLoading(true);\n        getRestaurant(handleRoute(location.pathname.split('/')[2]))\n            .then(res => {\n                if (res.status === 200) {\n                    setRestaurant(res.data.restaurant);\n                    setCuisines(res.data.cuisines);\n                    toast.success(res.data.message);\n                } else {\n                    toast.error(res.data.message)\n                }\n                setLoading(false);\n            })\n            .catch(error => {\n                toast.error(error);\n                setLoading(false);\n            })\n    }, [])\n\n    let itemsArr = [];\n    let cuisinesArr = [];\n    let index = -1;\n    let itemIndex = -1;\n\n    const handleAddProduct = (obj) => {\n        setLoading(true);\n        if (user) {\n            const { product, count } = obj;\n            let arr = {\n                cuisineId: product._id,\n                title: product.title,\n                description: product.description,\n                price: product.price,\n                count: count,\n                quantity: product.quantity,\n                images: product.images,\n            };\n            itemsArr = cart?.items || items;\n            itemIndex = itemsArr?.findIndex(item => item.orderFrom === restaurant?.email);\n            if (itemIndex !== -1) {\n                cuisinesArr = itemsArr[itemIndex]?.cuisines;\n                index = cuisinesArr && cuisinesArr.findIndex(item => item.cuisineId === arr.cuisineId);\n                if (index !== -1) {\n                    if (cuisinesArr[index].count === Number(arr.count)) {\n                        toast.error('Product exist in the cart with same count');\n                        setLoading(false);\n                    } else {\n                        cuisinesArr[index].count = arr.count;\n                        let dummyArr = {\n                            cuisines: cuisinesArr,\n                            orderFrom: restaurant?.email\n                        }\n                        itemsArr[itemIndex] = dummyArr;\n                        handleCommon();\n                    }\n                } else {\n                    cuisinesArr.push(arr);\n                    let dummyArr = {\n                        cuisines: cuisinesArr,\n                        orderFrom: restaurant?.email\n                    }\n                    itemsArr[itemIndex] = dummyArr;\n                    handleCommon();\n                }\n            } else {\n                cuisinesArr = [];\n                cuisinesArr.push(arr);\n                let dummyArr = {\n                    cuisines: cuisinesArr,\n                    orderFrom: restaurant?.email\n                }\n                itemsArr.push(dummyArr)\n                handleCommon();\n            }\n        } else {\n            setLoading(false);\n            toast.error('Please login/resgister to add items to the cart');\n            navigate('/login');\n        }\n    }\n\n    const handleCommon = () => {\n        let cartTotal = 0;\n        let cartQuantity = 0;\n        for (let i = 0; i < cuisinesArr.length; i++) {\n            cartTotal = cartTotal + cuisinesArr[i].price * cuisinesArr[i].count;\n            cartQuantity = cartQuantity + cuisinesArr[i].count;\n        }\n        let shipping = (cartTotal * 0.05).toFixed(2);\n        createOrUpdateCart({ items: itemsArr, shipping, cartTotal, cartQuantity, totalAfterDiscount: 100, orderdBy: user.email }, user.token)\n            .then(res => {\n                if (res.status === 200) {\n                    setItems(res.data.cart.items);\n                    dispatch({\n                        type: 'CART',\n                        payload: res.data.cart\n                    });\n                    toast.success(res.data.message);\n                } else {\n                    toast.error(res.data.message);\n                }\n                setLoading(false);\n            })\n            .catch((error) => {\n                setLoading(false);\n                toast.error(error);\n            })\n    }\n\n    return ({\n        handleAddProduct\n    })\n\n}\n\nexport default customHook;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}